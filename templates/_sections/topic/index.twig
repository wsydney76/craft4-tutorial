{% extends "_layouts/main.twig" %}

{% set allTopicIds = (entry.children.ids|push(entry.id)) %}

{% set latestPost = craft.entries.section('post').relatedTo(allTopicIds).one %}

{% do _globals.set({
    title: "#{'Topic'|t}: #{entry.title}",
    featuredImage: latestPost ? latestPost.featuredImage.one : null,
    mainWidth: 'xl'
}) %}

{% block content %}

    {% include '_sections/topics/hierarchy.twig' with {
    	entry
    } only %}

    {% include '_partials/entries-cards.twig' with {
        query: craft.entries.section('post')
            .relatedTo(allTopicIds)
    } only %}
{% endblock %}